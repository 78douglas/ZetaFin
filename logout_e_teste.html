<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logout e Teste - ZetaFin</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #ef4444;
        }
        pre {
            background: #000;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .btn {
            background: #ef4444;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .btn:hover {
            background: #dc2626;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success { background: #065f46; }
        .error { background: #7f1d1d; }
        .warning { background: #78350f; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Logout e Teste - ZetaFin</h1>
        
        <div class="section">
            <h2>A√ß√µes</h2>
            <button class="btn" onclick="fazerLogout()">üö™ Fazer Logout</button>
            <button class="btn" onclick="adicionarDadosTeste()">‚ûï Adicionar Dados de Teste</button>
            <button class="btn" onclick="verificarDados()">üîç Verificar localStorage</button>
            <button class="btn" onclick="limparTudo()">üóëÔ∏è Limpar Tudo</button>
        </div>

        <div class="section">
            <h3>Resultados:</h3>
            <div id="resultados">Clique em uma a√ß√£o para ver os resultados...</div>
        </div>
    </div>

    <script>
        function fazerLogout() {
            // Limpar dados de autentica√ß√£o
            localStorage.removeItem('sb-auzxgatnowthemvddgpg-auth-token');
            sessionStorage.removeItem('sb-auzxgatnowthemvddgpg-auth-token');
            
            // Limpar outros dados de sess√£o
            for (let i = localStorage.length - 1; i >= 0; i--) {
                const key = localStorage.key(i);
                if (key && key.includes('supabase')) {
                    localStorage.removeItem(key);
                }
            }
            
            for (let i = sessionStorage.length - 1; i >= 0; i--) {
                const key = sessionStorage.key(i);
                if (key && key.includes('supabase')) {
                    sessionStorage.removeItem(key);
                }
            }
            
            document.getElementById('resultados').innerHTML = 
                '<div class="status success"><p>‚úÖ Logout realizado! Recarregue a p√°gina principal.</p></div>';
        }
        
        function adicionarDadosTeste() {
            // Adicionar categorias padr√£o
            const categorias = [
                { id: '1', nome: 'Alimenta√ß√£o', tipo_padrao: 'DESPESA', cor: '#ef4444', icone: 'üçΩÔ∏è', ativa: true },
                { id: '2', nome: 'Transporte', tipo_padrao: 'DESPESA', cor: '#f97316', icone: 'üöó', ativa: true },
                { id: '3', nome: 'Moradia', tipo_padrao: 'DESPESA', cor: '#eab308', icone: 'üè†', ativa: true },
                { id: '19', nome: 'Sal√°rio', tipo_padrao: 'RECEITA', cor: '#10b981', icone: 'üí∞', ativa: true }
            ];
            localStorage.setItem('zetafin_categories', JSON.stringify(categorias));
            
            // Adicionar transa√ß√µes de teste baseadas no que o usu√°rio mencionou
            const hoje = new Date();
            const transacoes = [
                {
                    id: 'test-1',
                    descricao: 'Sal√°rio',
                    valor: 9999.99,
                    data: new Date(hoje.getTime() - 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    tipo: 'RECEITA',
                    categoria_id: '19',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                },
                {
                    id: 'test-2',
                    descricao: 'Aluguel',
                    valor: 999.99,
                    data: new Date(hoje.getTime() - 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    tipo: 'DESPESA',
                    categoria_id: '3',
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString()
                }
            ];
            localStorage.setItem('zetafin_transactions', JSON.stringify(transacoes));
            
            document.getElementById('resultados').innerHTML = 
                '<div class="status success"><p>‚úÖ Dados de teste adicionados! Total: R$ 10.999,98</p></div>';
        }
        
        function verificarDados() {
            const resultadosDiv = document.getElementById('resultados');
            let html = '';
            
            // Verificar transa√ß√µes
            const transacoes = localStorage.getItem('zetafin_transactions');
            html += '<div class="status ' + (transacoes ? 'success' : 'error') + '">';
            html += '<h4>üìä Transa√ß√µes (zetafin_transactions)</h4>';
            if (transacoes) {
                try {
                    const transacoesParsed = JSON.parse(transacoes);
                    html += `<p>‚úÖ Encontradas: ${transacoesParsed.length} transa√ß√µes</p>`;
                    html += '<pre>' + JSON.stringify(transacoesParsed, null, 2) + '</pre>';
                } catch (e) {
                    html += '<p>‚ùå Erro ao parsear dados: ' + e.message + '</p>';
                }
            } else {
                html += '<p>‚ùå Nenhuma transa√ß√£o encontrada</p>';
            }
            html += '</div>';
            
            // Verificar categorias
            const categorias = localStorage.getItem('zetafin_categories');
            html += '<div class="status ' + (categorias ? 'success' : 'error') + '">';
            html += '<h4>üè∑Ô∏è Categorias (zetafin_categories)</h4>';
            if (categorias) {
                try {
                    const categoriasParsed = JSON.parse(categorias);
                    html += `<p>‚úÖ Encontradas: ${categoriasParsed.length} categorias</p>`;
                    html += '<pre>' + JSON.stringify(categoriasParsed, null, 2) + '</pre>';
                } catch (e) {
                    html += '<p>‚ùå Erro ao parsear dados: ' + e.message + '</p>';
                }
            } else {
                html += '<p>‚ùå Nenhuma categoria encontrada</p>';
            }
            html += '</div>';
            
            resultadosDiv.innerHTML = html;
        }
        
        function limparTudo() {
            localStorage.removeItem('zetafin_transactions');
            localStorage.removeItem('zetafin_categories');
            
            // Limpar dados de autentica√ß√£o tamb√©m
            localStorage.removeItem('sb-auzxgatnowthemvddgpg-auth-token');
            sessionStorage.removeItem('sb-auzxgatnowthemvddgpg-auth-token');
            
            document.getElementById('resultados').innerHTML = 
                '<div class="status warning"><p>üóëÔ∏è Todos os dados removidos!</p></div>';
        }
    </script>
</body>
</html>